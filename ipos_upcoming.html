<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Upcoming IPOs - Stock Portal</title>
  <link rel="icon" href="favicon.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: 'class' };</script>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
  <nav class="sticky top-0 bg-blue-900 p-4 flex justify-between items-center">
    <a href="index.html" class="text-lg font-bold">‚Üê Back</a>
    <h1 class="font-semibold">Upcoming IPOs</h1>
  </nav>

  <main class="max-w-6xl mx-auto p-4">
    <input id="searchBox" onkeyup="searchContent()" placeholder="Search upcoming IPOs..." class="w-full p-2 rounded mb-4 text-black" />
    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead class="bg-gray-800 text-left">
          <tr>
            <th class="px-2 py-2">Name</th>
            <th class="px-2 py-2">Issue Type</th>
            <th class="px-2 py-2">Price Band</th>
            <th class="px-2 py-2">Open Date</th>
            <th class="px-2 py-2">Close Date</th>
            <th class="px-2 py-2">Issue Size</th>
          </tr>
        </thead>
        <tbody id="upcomingBody" class="searchable"></tbody>
      </table>
    </div>

    <div id="footerArea" class="mt-8"></div>
  </main>

  <script src="common.js"></script>
  <script>
    // script-ipos_upcoming.js
    (async function(){
      const body = document.getElementById("upcomingBody");
      showLoader("upcomingBody");
      try {
        const data = await fetchData();
        console.log("Upcoming IPOs API Response: ", data);
        const rows = data.ipos_upcoming || [];
        body.innerHTML = "";
        if (rows.length === 0) {
          body.innerHTML = `<tr><td colspan="6" class="p-4 text-gray-400">No upcoming IPOs found.</td></tr>`;
        } else {
          rows.forEach(r => {
            body.innerHTML += `<tr class="border-b border-gray-700">
              <td class="px-2 py-2">${r.Name || ""}</td>
              <td class="px-2 py-2">${r["Issue Type"] || ""}</td>
              <td class="px-2 py-2">${r["Price Band"] || ""}</td>
              <td class="px-2 py-2">${formatDateToDDMMYYYY(r["Open Date"] || "")}</td>
              <td class="px-2 py-2">${formatDateToDDMMYYYY(r["Close Date"] || "")}</td>
              <td class="px-2 py-2">${r["Issue Size"] || ""}</td>
            </tr>`;
          });
        }
      } catch (e) {
        body.innerHTML = `<tr><td colspan="6" class="p-4 text-red-400">Error loading IPOs: ${e.message}</td></tr>`;
        console.error(e);
      } finally {
        renderFooter("footerArea");
      }
    })();
  </script>
</body>
</html>
<!doctype html>
<html>
<head><link rel="icon" type="image/png" href="favicon.png" />
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>All News - Stock Portal</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 p-6">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-2xl font-bold mb-4">All News</h1>
    <div id="list"></div>

    <div class="flex justify-between items-center mt-6">
      <button id="prev" class="px-3 py-1 bg-gray-200 rounded">Prev</button>
      <div id="pageinfo"></div>
      <button id="next" class="px-3 py-1 bg-gray-200 rounded">Next</button>
    </div>
  </div>

<script>
  const API_URL = "https://script.google.com/macros/s/AKfycbwYZkPrhsuVjBW__0b9QJGXyCq4pf6uSCV1utTEv4znLMnxfNt6bMGNlYNvm4UCK8bT/exec";
  let currentPage = 1, perPage = 20, dataset = [];

  async function loadAll() {
    try {
      const r = await fetch(API_URL);
      const json = await r.json();
      dataset = json.news || json.News || [];
      renderPage();
    } catch (e) {
      document.getElementById('list').innerHTML = '<div class="text-red-500">Failed to load news.</div>';
      console.error(e);
    }
  }

  function renderPage(){
    const start = (currentPage-1)*perPage;
    const page = dataset.slice(start, start+perPage);
    const html = page.map(n=>{
      const title = n.headline||n.Title||n.Headline||'';
      const link = n.link||n.Link||'#';
      const date = n.date || n.Date || '';
      return `<div class="p-3 bg-white dark:bg-gray-800 rounded mb-2">
        <a href="${link}" target="_blank" class="font-medium">${title}</a>
        <div class="text-xs text-gray-500 mt-1">${date}</div>
      </div>`;
    }).join('');
    document.getElementById('list').innerHTML = html || '<div>No news found.</div>';
    document.getElementById('pageinfo').innerText = `Page ${currentPage} of ${Math.max(1, Math.ceil(dataset.length/perPage))}`;
  }

  document.getElementById('prev').addEventListener('click', ()=>{ if(currentPage>1){ currentPage--; renderPage(); }});
  document.getElementById('next').addEventListener('click', ()=>{ if(currentPage*perPage < dataset.length){ currentPage++; renderPage(); }});

  loadAll();
</script>
</body>
</html>
